
col osuser format a11
col program format a25
col module format a25
set lines 1111
select --p.*, 
   p.spid,s.sid,s.serial#,s.username,s.status,s.last_call_et,
   --p.program,
   --p.terminal,--logon_time,
   module,s.osuser,
   sql_id, sql_exec_start,
   prev_sql_id,
    BLOCKING_SESSION_STATUS,                                              
    BLOCKING_INSTANCE     ,                                               
    BLOCKING_SESSION      ,                                               
    FINAL_BLOCKING_SESSION_STATUS,                                        
    FINAL_BLOCKING_INSTANCE      ,                                        
 FINAL_BLOCKING_SESSION   ,
 state, event, p1, p1text, p2, p2text, p3, p3text
from V$process p,V$session s
where s.paddr = p.addr 
  and s.sid=118;
/


SQL> r
  1  select sql_text from v$sql
  2  where sql_id = '&sql_id'
  3*
Enter value for sql_id: g0h5vw9mxcf6h
old   2: where sql_id = '&sql_id'
new   2: where sql_id = 'g0h5vw9mxcf6h'

SQL_TEXT
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
update call_sessions set last_call_status=:1  where csid=:2



Õ van blokkolva:
SPID                            SID    SERIAL# USERNAME                       STATUS   LAST_CALL_ET MODULE                    OSUSER      SQL_ID        SQL_EXEC_START  BLOCKING_SE BLOCKING_INSTANCE BLOCKING_SESSION FINAL_BLOCK FINAL_BLOCKING_INSTANCE FINAL_BLOCKING_SESSION STATE               EVENT                                                                    P1 P1TEXT                                                                   P2 P2TEXT                                                                   P3 P3TEXT                                                           ROW_WAIT_OBJ# ROW_WAIT_FILE# ROW_WAIT_BLOCK# ROW_WAIT_ROW#
------------------------ ---------- ---------- ------------------------------ -------- ------------ ------------------------- ----------- ------------- --------------- ----------- ----------------- ---------------- ----------- ----------------------- ---------------------- ------------------- ---------------------------------------------------------------- ---------- ---------------------------------------------------------------- ---------- ---------------------------------------------------------------- ---------- ---------------------------------------------------------------- ------------- -------------- --------------- -------------
65798276                         91      43561 CM                             ACTIVE           5588 JDBC Thin Client          mmccsys     g0h5vw9mxcf6h 03-AUG-16       VALID                       1              118 VALID                             1                    118 WAITING             enq: TX - row lock contention                                    1415053318 name|mode                                                            655379 usn<<16 | slot                                                       849771 sequence                                                                 59468             15          195856            13

Õ blokkol
SPID                            SID    SERIAL# USERNAME                       STATUS   LAST_CALL_ET MODULE                    OSUSER      SQL_ID        SQL_EXEC_START  PREV_SQL_ID   BLOCKING_SE BLOCKING_INSTANCE BLOCKING_SESSION FINAL_BLOCK FINAL_BLOCKING_INSTANCE FINAL_BLOCKING_SESSION STATE               EVENT                                                                    P1 P1TEXT                                                                   P2 P2TEXT                                                                   P3 P3TEXT
------------------------ ---------- ---------- ------------------------------ -------- ------------ ------------------------- ----------- ------------- --------------- ------------- ----------- ----------------- ---------------- ----------- ----------------------- ---------------------- ------------------- ---------------------------------------------------------------- ---------- ---------------------------------------------------------------- ---------- ---------------------------------------------------------------- ---------- ----------------------------------------------------------------
11534668                        118      43605 CM                             INACTIVE         5379 mts.callman@mmccv2-mtsrou mmccsys                                   9pp4m81xcc9yw NO HOLDER                                      NO HOLDER                                                  WAITING             SQL*Net message from client                                      1413697536 driver id                                                                 1 #bytes                                                                    0
                                                                                                    ting-production (TNS V1




 ROW_WAIT_OBJ# ROW_WAIT_FILE# ROW_WAIT_BLOCK# ROW_WAIT_ROW#
 ------------- -------------- --------------- -------------
         59468             15          195856            13
       
OWNER                          OBJECT_TYPE         OBJECT_NAME
------------------------------ ------------------- ------------------------------
CM                             TABLE               CALL_SESSIONS

select
    owner||'.'||object_name||':'||nvl(subobject_name,'-') obj_name,
    dbms_rowid.rowid_create (
        1,
        o.data_object_id,
        row_wait_file#,
        row_wait_block#,
        row_wait_row#
    ) row_id
from v$session s, dba_objects o
where sid = &sid
and o.data_object_id = s.row_wait_obj#;       

OBJ_NAME                 ROW_ID
------------------------ ------------------
CM.CALL_SESSIONS:-       AAAOhMAAPAAAv0QAAN

select * from cm.call_sessions where rowid=  'AAAOhMAAPAAAv0QAAN';
       
select owner, object_type, object_name from dba_objects where object_id =  59468;     
select * from v$lock where sid in (91,118) ;

select * from v$lock where sid in (91,118) ;SQL>

ADDR             KADDR                   SID TY        ID1        ID2      LMODE    REQUEST      CTIME      BLOCK
---------------- ---------------- ---------- -- ---------- ---------- ---------- ---------- ---------- ----------
070000013731CF28 070000013731CF80         91 TX     655379     849771          0          6       5321          0
0700000137320230 0700000137320288        118 AE        100          0          4          0      12779          0
0700000137320DA8 0700000137320E00         91 AE        100          0          4          0       5875          0
000000011090A3D8 000000011090A438        118 TM      59386          0          3          0       5329          0
000000011090A3D8 000000011090A438        118 TM      59392          0          3          0       5329          0
000000011090A3D8 000000011090A438        118 TM      59425          0          3          0       5329          0
000000011090A3D8 000000011090A438        118 TM      59452          0          3          0       5329          0
000000011090A3D8 000000011090A438        118 TM      59468          0          3          0       5329          0
000000011090A3D8 000000011090A438         91 TM      59411          0          3          0       5321          0
000000011090A3D8 000000011090A438         91 TM      59468          0          3          0       5321          0
0700000137ECF4D0 0700000137ECF548        118 TX     655379     849771          6          0       5329          1

ADDR             KADDR                   SID TY        ID1        ID2      LMODE    REQUEST      CTIME      BLOCK
---------------- ---------------- ---------- -- ---------- ---------- ---------- ---------- ---------- ----------
0700000131F6CB90 0700000131F6CC08         91 TX     589826     722251          6          0       5321          0


begin routing.find_target(:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13); end;
9pp4m81xcc9yw

select prev_sql_id, to_char(prev_exec_start,'YYYY/MM/DD HH24:MI:SS') as last_sql_start 
from v$session
where sid= 118;
